<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Abc, A" />










<meta property="og:type" content="article">
<meta property="og:title" content="MYSQL详解">
<meta property="og:url" content="http://yoursite.com/2018/12/16/MYSQL详解/index.html">
<meta property="og:site_name" content="Caiiiiii&#39;s blog">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/bfd348c6gy1fy8wo6e1hgj20xc0mkgvf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/bfd348c6ly1fy7kmfmfjgj20cq037glr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/bfd348c6gy1fy7ul8hri5j20rs08n3yr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/bfd348c6gy1fy7um31dprj20sj06v74m.jpg">
<meta property="og:updated_time" content="2018-12-16T13:27:04.576Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MYSQL详解">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/bfd348c6gy1fy8wo6e1hgj20xc0mkgvf.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"Left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/12/16/MYSQL详解/"/>





  <title>MYSQL详解 | Caiiiiii's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-Left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Caiiiiii's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">来局昆特牌吗？</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/16/MYSQL详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Caiiiiii">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/bz.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Caiiiiii's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MYSQL详解</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-16T00:34:47+08:00">
                2018-12-16
              </time>
              </span>
              
  <span class="post-updated">
    &nbsp; | &nbsp; 更新于
    <time itemprop="dateUpdated" datetime="2018-12-16T21:27:04+08:00" content="2018-12-16">
      2018-12-16
    </time>
  </span>

            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://ww1.sinaimg.cn/large/bfd348c6gy1fy8wo6e1hgj20xc0mkgvf.jpg" alt=""><br><a id="more"></a></p>
<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>用来加快查询的技术很多，其中最重要的是索引。通常索引能够快速提高查询速度。</p>
<h2 id="索引的本质"><a href="#索引的本质" class="headerlink" title="索引的本质"></a>索引的本质</h2><p>MySQL官方对索引的定义为：索引（Index）是帮助MySQL高效获取数据的数据结构。提取句子主干，就可以得到索引的本质：索引是数据结构。</p>
<h2 id="索引的类型"><a href="#索引的类型" class="headerlink" title="索引的类型"></a>索引的类型</h2><p>索引是在MYSQL的存储引擎层中实现的，而不是在服务层实现的。所以不同存储引擎具有不同的索引类型和实现。</p>
<ul>
<li>B-Tree 索引：最常见的索引类型，大部分引擎都支持B树索引。</li>
<li>HASH 索引：只有Memory引擎支持，使用场景简单。</li>
<li>R-Tree 索引(空间索引)：空间索引是MyISAM的一种特殊索引类型，主要用于地理空间数据类型。</li>
<li>Full-text (全文索引)：全文索引也是MyISAM的一种特殊索引类型，主要用于全文索引，InnoDB从MYSQL5.6版本提供对全文索引的支持。</li>
</ul>
<p><strong>MyISAM、InnoDB引擎、Memory三个常用引擎类型比较</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">索引</th>
<th style="text-align:center">MyISAM引擎</th>
<th style="text-align:center">InnoDB引擎</th>
<th style="text-align:center">Memory引擎</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">B-Tree索引</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">支持</td>
</tr>
<tr>
<td style="text-align:center">HASH索引</td>
<td style="text-align:center">不支持</td>
<td style="text-align:center">不支持</td>
<td style="text-align:center">支持</td>
</tr>
<tr>
<td style="text-align:center">R-Tree索引</td>
<td style="text-align:center">支持</td>
<td style="text-align:center">不支持</td>
<td style="text-align:center">不支持</td>
</tr>
<tr>
<td style="text-align:center">Full-text索引</td>
<td style="text-align:center">不支持</td>
<td style="text-align:center">暂不支持</td>
<td style="text-align:center">不支持</td>
</tr>
</tbody>
</table>
<h2 id="索引种类"><a href="#索引种类" class="headerlink" title="索引种类"></a>索引种类</h2><ul>
<li><p>普通索引<br>这是最基本的索引类型，而且它没有唯一性之类的限制。普通索引可以通过以下几种方式创建：</p>
<p>&nbsp;&nbsp;(1)创建索引：CREATE INDEX 索引名 ON 表名(列名1，列名2,…);<br>（2）修改表: ALTER TABLE 表名ADD INDEX 索引名 (列名1，列名2,…);<br>（3）创建表时指定索引：CREATE TABLE 表名 ( […], INDEX 索引名 (列名1，列名 2,…) );</p>
</li>
<li><p>UNIQUE索引<br>表示唯一的，不允许重复的索引，如果该字段信息保证不会重复例如身份证号用作索引时，可设置为unique：<br>（1）创建索引：CREATE UNIQUE INDEX 索引名 ON 表名(列的列表);<br>（2）修改表：ALTER TABLE 表名ADD UNIQUE 索引名 (列的列表);<br>（3）创建表时指定索引：CREATE TABLE 表名( […], UNIQUE 索引名 (列的列表) );</p>
</li>
<li><p>主键：PRIMARY KEY索引<br>主键是一种唯一性索引，但它必须指定为“PRIMARY KEY”。<br>（1）主键一般在创建表的时候指定：“CREATE TABLE 表名( […], PRIMARY KEY (列的列表) ); ”。<br>（2）但是，我们也可以通过修改表的方式加入主键：“ALTER TABLE 表名ADD PRIMARY KEY (列的列表); ”。<br>每个表只能有一个主键。 （主键相当于聚合索引，是查找最快的索引）</p>
</li>
</ul>
<p><strong>注：不能用CREATE INDEX语句创建PRIMARY KEY索引</strong></p>
<h2 id="索引的设置语法"><a href="#索引的设置语法" class="headerlink" title="索引的设置语法"></a>索引的设置语法</h2><h3 id="1、设置索引"><a href="#1、设置索引" class="headerlink" title="1、设置索引"></a>1、设置索引</h3><p>在执行CREATE TABLE语句时可以创建索引，也可以单独用CREATE INDEX或ALTER TABLE来为表增加索引。</p>
<p>1.<strong>ALTER TABLE</strong> - ALTER TABLE用来创建<strong>普通索引、UNIQUE索引</strong>或<strong>PRIMARY KEY索引</strong>。</p>
<ul>
<li>ALTER TABLE table_name ADD <strong>INDEX</strong> index_name (column_list)</li>
<li>ALTER TABLE table_name ADD <strong>UNIQUE</strong> (column_list)</li>
<li>ALTER TABLE table_name ADD <strong>PRIMARY KEY</strong> (column_list)</li>
</ul>
<p>2.<strong>CREATE INDEX</strong> - CREATE INDEX可对表增加普通索引或UNIQUE索引。</p>
<ul>
<li>CREATE <strong>INDEX</strong> index_name ON table_name (column_list)</li>
<li>CREATE <strong>UNIQUE</strong> INDEX index_name ON table_name (column_list)</li>
</ul>
<h3 id="2-删除索引"><a href="#2-删除索引" class="headerlink" title="2.删除索引"></a>2.删除索引</h3><p>可利用ALTER TABLE或DROP INDEX语句来删除索引。类似于CREATE INDEX语句，DROP INDEX可以在ALTER TABLE内部作为一条语句处理，语法如下。</p>
<ul>
<li>DROP <strong>INDEX</strong> index_name ON talbe_name</li>
<li>ALTER TABLE table_name DROP <strong>INDEX</strong> index_name</li>
<li>ALTER TABLE table_name DROP <strong>PRIMARY KEY</strong></li>
</ul>
<p>其中，前两条语句是等价的，删除掉table_name中的索引index_name。<br>第3条语句只在删除PRIMARY KEY索引时使用，因为一个表只可能有一个PRIMARY KEY索引，因此不需要指定索引名。如果没有创建PRIMARY KEY索引，但表具有一个或多个UNIQUE索引，则MySQL将删除第一个UNIQUE索引。</p>
<blockquote>
<p>如果从表中删除了某列，则索引会受到影响。对于多列组合的索引，如果删除其中的某列，则该列也会从索引中删除。如果删除组成索引的所有列，则整个索引将被删除。</p>
</blockquote>
<h3 id="3-查看索引"><a href="#3-查看索引" class="headerlink" title="3.查看索引"></a>3.查看索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show index from tblname;</span><br><span class="line">mysql&gt; show keys from tblname;</span><br></pre></td></tr></table></figure>
<ul>
<li>Table:表的名称</li>
<li>Non_unique：如果索引不能包括重复词，则为0。如果可以，则为1</li>
<li>Key_name：索引的名称</li>
<li>Seq_in_index：索引中的列序列号，从1开始</li>
<li>Column_name：列名称</li>
<li>Collation：列以什么方式存储在索引中。在MySQL中，有值‘A’（升序）或NULL（无分类）。</li>
<li>Cardinality：索引中唯一值的数目的估计值。通过运行ANALYZE TABLE或myisamchk -a可以更新。基数根据被存储为整数的统计数据来计数，所以即使对于小型表，该值也没有必要是精确的。基数越大，当进行联合时，MySQL使用该索引的机会就越大。</li>
<li>Sub_part：如果列只是被部分地编入索引，则为被编入索引的字符的数目。如果整列被编入索引，则为NULL。</li>
<li>Packed：指示关键字如何被压缩。如果没有被压缩，则为NULL。</li>
<li>Null：如果列含有NULL，则含有YES。如果没有，则该列含有NO。</li>
<li>Index_type：用过的索引方法（BTREE, FULLTEXT, HASH, RTREE）。</li>
<li>Comment：更多评注。</li>
</ul>
<h1 id="B-Tree"><a href="#B-Tree" class="headerlink" title="B-Tree"></a>B-Tree</h1><h2 id="B-tree结构"><a href="#B-tree结构" class="headerlink" title="B-tree结构"></a>B-tree结构</h2><p>为了描述B-Tree，首先定义一条数据记录为一个<strong>二元组[key, data]</strong>，key为记录的键值，对于不同数据记录，key是互不相同的；data为数据记录除key外的数据。那么B-Tree是满足下列条件的数据结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">d&gt;=2，即B-Tree的度；</span><br><span class="line"></span><br><span class="line">h为B-Tree的高；</span><br><span class="line"></span><br><span class="line">每个非叶子结点由n-1个key和n个指针组成，其中d&lt;=n&lt;=2d；</span><br><span class="line"></span><br><span class="line">每个叶子结点至少包含一个key和两个指针，最多包含2d-1个key和2d个指针，叶结点的指针均为NULL；</span><br><span class="line"></span><br><span class="line">所有叶结点都在同一层，深度等于树高h；</span><br><span class="line"></span><br><span class="line">key和指针相互间隔，结点两端是指针；</span><br><span class="line"></span><br><span class="line">一个结点中的key从左至右非递减排列；</span><br><span class="line"></span><br><span class="line">如果某个指针在结点node最左边且不为null，则其指向结点的所有key小于v(key1)，其中v(key1)为node的第一个key的值。</span><br><span class="line"></span><br><span class="line">如果某个指针在结点node最右边且不为null，则其指向结点的所有key大于v(keym)，其中v(keym)为node的最后一个key的值。</span><br><span class="line"></span><br><span class="line">如果某个指针在结点node的左右相邻key分别是keyi和keyi+1且不为null，则其指向结点的所有key小于v(keyi+1)且大于v(keyi)。</span><br></pre></td></tr></table></figure>
<p>下图是一个d=2的B-Tree示意图。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="http://ww1.sinaimg.cn/large/bfd348c6ly1fy7kmfmfjgj20cq037glr.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/bfd348c6gy1fy7ul8hri5j20rs08n3yr.jpg" alt=""></p>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>进行查找操作时，首先在根节点进行二分查找，找到一个 key 所在的指针，然后递归地在指针所指向的节点进行查找。直到查找到叶子节点，然后在叶子节点上进行二分查找，找出 key 所对应的 data。</p>
<p>插入删除操作会破坏平衡树的平衡性，因此在插入删除操作之后，需要对树进行一个分裂、合并、旋转等操作来维护平衡性。</p>
<h1 id="B-Tree-1"><a href="#B-Tree-1" class="headerlink" title="B+Tree"></a>B+Tree</h1><h2 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h2><p>B-Tree有许多变种，其中最常见的是B+Tree，例如MySQL就普遍使用B+Tree实现其索引结构。</p>
<p>与B-Tree相比，B+Tree有以下不同点：</p>
<blockquote>
<p>每个结点的指针上限为2d而不是2d+1。<strong>(对此有疑惑)</strong><br>内结点不存储data，只存储key；叶子结点不存储指针。</p>
</blockquote>
<p>图3是一个简单的B+Tree示意。<br><img src="http://ww1.sinaimg.cn/large/bfd348c6gy1fy7um31dprj20sj06v74m.jpg" alt=""></p>
<h2 id="为啥用B-Tree"><a href="#为啥用B-Tree" class="headerlink" title="为啥用B+Tree"></a>为啥用B+Tree</h2><p>典型的B-tree节点，其中最大的问题在于，如果data所占空间太大，那么我们不得不选择一个较小的B值，而B值过小又无法保证合理的树高。更加麻烦的是，在实现B-tree时，我们往往并不知道data有多大。考虑到上述这些困境，B+tree应运而生。下图展示了典型的B+tree节点，其中最大的变化在于，内部节点不再保存数据，因此每个内部节点得到了更多的空间来存储key值，进一步发挥了B-tree的优势。同时外部节点的实现也有了更多的想象空间，它可以是硬盘中的一页数据，也可以是网络中的某台计算机。如果是用来实现数据库索引，通常还会在外部节点之间添加指向下一节点的指针，这样可以更好的支持范围查询操作。</p>
<h1 id="哈希索引"><a href="#哈希索引" class="headerlink" title="哈希索引"></a>哈希索引</h1><p>哈希索引能以 O(1) 时间进行查找，但是失去了有序性：</p>
<ul>
<li>无法用于排序与分组；</li>
<li>只支持精确查找，无法用于部分查找和范围查找。</li>
</ul>
<p>InnoDB 存储引擎有一个特殊的功能叫“自适应哈希索引”，当某个索引值被使用的非常频繁时，会在 B+Tree 索引之上再创建一个哈希索引，这样就让 B+Tree 索引具有哈希索引的一些优点，比如快速的哈希查找。</p>
<h1 id="全文索引"><a href="#全文索引" class="headerlink" title="全文索引"></a>全文索引</h1><p>MyISAM 存储引擎支持全文索引，用于查找文本中的关键词，而不是直接比较是否相等。</p>
<p>查找条件使用 MATCH AGAINST，而不是普通的 WHERE。</p>
<p>全文索引使用倒排索引实现，它记录着关键词到其所在文档的映射。</p>
<p>InnoDB 存储引擎在 MySQL 5.6.4 版本中也开始支持全文索引。</p>
<h1 id="空间数据索引"><a href="#空间数据索引" class="headerlink" title="空间数据索引"></a>空间数据索引</h1><p>MyISAM 存储引擎支持空间数据索引（R-Tree），可以用于地理数据存储。空间数据索引会从所有维度来索引数据，可以有效地使用任意维度来进行组合查询。</p>
<p>必须使用 GIS 相关的函数来维护数据。</p>
<h1 id="索引的优化（MYSQL对千万级大表该怎么优化？）"><a href="#索引的优化（MYSQL对千万级大表该怎么优化？）" class="headerlink" title="索引的优化（MYSQL对千万级大表该怎么优化？）"></a>索引的优化（MYSQL对千万级大表该怎么优化？）</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.zhihu.com/question/19719997</span><br><span class="line">https://github.com/CyC2018/CS-Notes/blob/master/notes/MySQL.md</span><br></pre></td></tr></table></figure>
<h2 id="1、优化你的SQL语句和索引"><a href="#1、优化你的SQL语句和索引" class="headerlink" title="1、优化你的SQL语句和索引"></a>1、优化你的SQL语句和索引</h2><h2 id="2、加缓存。memcached，redis；"><a href="#2、加缓存。memcached，redis；" class="headerlink" title="2、加缓存。memcached，redis；"></a>2、加缓存。memcached，redis；</h2><p>关于 memcached 和 redis<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/xifeijian/article/details/21994941</span><br><span class="line"></span><br><span class="line">http://wiki.jikexueyuan.com/project/redis/preliminary-redis.html</span><br></pre></td></tr></table></figure></p>
<h2 id="3、主从复制或主主复制，读写分离，可以在应用层做，效率高"><a href="#3、主从复制或主主复制，读写分离，可以在应用层做，效率高" class="headerlink" title="3、主从复制或主主复制，读写分离，可以在应用层做，效率高"></a>3、主从复制或主主复制，读写分离，可以在应用层做，效率高</h2><p>关于主从复制和主主复制<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://blog.51cto.com/ximenfeibing/1665272</span><br></pre></td></tr></table></figure></p>
<h2 id="4、进行MYSQL表分区。"><a href="#4、进行MYSQL表分区。" class="headerlink" title="4、进行MYSQL表分区。"></a>4、进行MYSQL表分区。</h2><p>mysql自带分区表，先试试这个，对你的应用是透明的，无需更改代码,但是sql语句是需要针对分区表做优化的，sql条件中要带上分区条件的列，从而使查询定位到少量的分区上</p>
<h2 id="5、垂直拆分"><a href="#5、垂直拆分" class="headerlink" title="5、垂直拆分"></a>5、垂直拆分</h2><h2 id="6、水平切分"><a href="#6、水平切分" class="headerlink" title="6、水平切分"></a>6、水平切分</h2><h1 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h1><h2 id="InnoDB"><a href="#InnoDB" class="headerlink" title="InnoDB"></a>InnoDB</h2><p>是 MySQL 默认的事务型存储引擎，只有在需要它不支持的特性时，才考虑使用其它存储引擎。</p>
<p>实现了四个标准的隔离级别，默认级别是可重复读（REPEATABLE READ）。在可重复读隔离级别下，通过多版本并发控制（MVCC）+ 间隙锁（Next-Key Locking）防止幻影读。</p>
<p>主索引是聚簇索引，在索引中保存了数据，从而避免直接读取磁盘，因此对查询性能有很大的提升。</p>
<p>内部做了很多优化，包括从磁盘读取数据时采用的可预测性读、能够加快读操作并且自动创建的自适应哈希索引、能够加速插入操作的插入缓冲区等。</p>
<p>支持真正的在线热备份。其它存储引擎不支持在线热备份，要获取一致性视图需要停止对所有表的写入，而在读写混合场景中，停止写入可能也意味着停止读取。</p>
<h2 id="MyISAM"><a href="#MyISAM" class="headerlink" title="MyISAM"></a>MyISAM</h2><p>设计简单，数据以紧密格式存储。对于只读数据，或者表比较小、可以容忍修复操作，则依然可以使用它。</p>
<p>提供了大量的特性，包括压缩表、空间数据索引等。</p>
<p>不支持事务。</p>
<p>不支持行级锁，只能对整张表加锁，读取时会对需要读到的所有表加共享锁，写入时则对表加排它锁。但在表有读取操作的同时，也可以往表中插入新的记录，这被称为并发插入（CONCURRENT INSERT）。</p>
<p>可以手工或者自动执行检查和修复操作，但是和事务恢复以及崩溃恢复不同，可能导致一些数据丢失，而且修复操作是非常慢的。</p>
<p>如果指定了 DELAY_KEY_WRITE 选项，在每次修改执行完成时，不会立即将修改的索引数据写入磁盘，而是会写到内存中的键缓冲区，只有在清理键缓冲区或者关闭表的时候才会将对应的索引块写入磁盘。这种方式可以极大的提升写入性能，但是在数据库或者主机崩溃时会造成索引损坏，需要执行修复操作。</p>
<h2 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h2><ul>
<li><p>事务：InnoDB 是事务型的，可以使用 Commit 和 Rollback 语句。</p>
</li>
<li><p>并发：MyISAM 只支持表级锁，而 InnoDB 还支持行级锁。</p>
</li>
<li><p>外键：InnoDB 支持外键。</p>
</li>
<li><p>备份：InnoDB 支持在线热备份。</p>
</li>
<li><p>崩溃恢复：MyISAM 崩溃后发生损坏的概率比 InnoDB 高很多，而且恢复的速度也更慢。</p>
</li>
<li><p>其它特性：MyISAM 支持压缩表和空间数据索引。</p>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/12/数据库系统原理/" rel="next" title="数据库系统原理">
                <i class="fa fa-chevron-left"></i> 数据库系统原理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/21/操作系统基础/" rel="prev" title="操作系统基础">
                操作系统基础 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/bz.gif"
                alt="Caiiiiii" />
            
              <p class="site-author-name" itemprop="name">Caiiiiii</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Caiiiiii" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:995017591@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/cai-yuan-qin/activities" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-globe"></i>知乎</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://steamcommunity.com/id/995017591" target="_blank" title="Steam">
                      
                        <i class="fa fa-fw fa-globe"></i>Steam</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#索引"><span class="nav-number">1.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念"><span class="nav-number">1.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#索引的本质"><span class="nav-number">1.2.</span> <span class="nav-text">索引的本质</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#索引的类型"><span class="nav-number">1.3.</span> <span class="nav-text">索引的类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#索引种类"><span class="nav-number">1.4.</span> <span class="nav-text">索引种类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#索引的设置语法"><span class="nav-number">1.5.</span> <span class="nav-text">索引的设置语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、设置索引"><span class="nav-number">1.5.1.</span> <span class="nav-text">1、设置索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-删除索引"><span class="nav-number">1.5.2.</span> <span class="nav-text">2.删除索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-查看索引"><span class="nav-number">1.5.3.</span> <span class="nav-text">3.查看索引</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#B-Tree"><span class="nav-number">2.</span> <span class="nav-text">B-Tree</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#B-tree结构"><span class="nav-number">2.1.</span> <span class="nav-text">B-tree结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作"><span class="nav-number">2.2.</span> <span class="nav-text">操作</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#B-Tree-1"><span class="nav-number">3.</span> <span class="nav-text">B+Tree</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念-1"><span class="nav-number">3.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#为啥用B-Tree"><span class="nav-number">3.2.</span> <span class="nav-text">为啥用B+Tree</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#哈希索引"><span class="nav-number">4.</span> <span class="nav-text">哈希索引</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#全文索引"><span class="nav-number">5.</span> <span class="nav-text">全文索引</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#空间数据索引"><span class="nav-number">6.</span> <span class="nav-text">空间数据索引</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#索引的优化（MYSQL对千万级大表该怎么优化？）"><span class="nav-number">7.</span> <span class="nav-text">索引的优化（MYSQL对千万级大表该怎么优化？）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、优化你的SQL语句和索引"><span class="nav-number">7.1.</span> <span class="nav-text">1、优化你的SQL语句和索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、加缓存。memcached，redis；"><span class="nav-number">7.2.</span> <span class="nav-text">2、加缓存。memcached，redis；</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、主从复制或主主复制，读写分离，可以在应用层做，效率高"><span class="nav-number">7.3.</span> <span class="nav-text">3、主从复制或主主复制，读写分离，可以在应用层做，效率高</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、进行MYSQL表分区。"><span class="nav-number">7.4.</span> <span class="nav-text">4、进行MYSQL表分区。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、垂直拆分"><span class="nav-number">7.5.</span> <span class="nav-text">5、垂直拆分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、水平切分"><span class="nav-number">7.6.</span> <span class="nav-text">6、水平切分</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#存储引擎"><span class="nav-number">8.</span> <span class="nav-text">存储引擎</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#InnoDB"><span class="nav-number">8.1.</span> <span class="nav-text">InnoDB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MyISAM"><span class="nav-number">8.2.</span> <span class="nav-text">MyISAM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#比较"><span class="nav-number">8.3.</span> <span class="nav-text">比较</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Caiiiiii</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  








  












  





  

  

  

  
  

  

  

  

</body>
</html>
