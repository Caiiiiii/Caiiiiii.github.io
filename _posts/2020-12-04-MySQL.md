---
layout:     post
title:      "MySQL 数据库"
subtitle:   "Hello World, Hello Blog"
date:       2020-12-04
author:     "Caiiiiii"
catalog:    true
header-img: "img/steam12-9-1.jpg"
tags:
    - MySQL
    - 数据库  
---

# MySQL
MySQL 是一种关系型数据库，在Java企业级开发中非常常用，MySQL的默认端口号是3306。

## 存储引擎
MySQL 5.5版本前的默认的存储引擎是MyISAM ，MySQL 5.5版本后的默认的存储引擎是InnoDB

### 两者存储引擎的区别

 - 是否支持行级锁：MyISAM只有表级锁，InnoDB有表级锁和行级锁
 - 是否支持事务和崩溃后d的安全恢复：MyISAM强调的是性能，不支持事务。InnoDB提供事务支持，外部键等高级操作，具有事务、回滚、崩溃修复功能的事务安全形表。
 - 是否支持外键：MyISAM不支持，InnoDB支持。

 ## 索引
MySQL索引使用的数据结构主要有BTree索引 和 哈希索引 。
单条记录查询的时候，可以选择哈希索引，查询性能最快；其余大部分场景，建议选择BTree索引。


## 什么是事务?
事务是逻辑上的一组操作，要么都执行，要么都不执行。

### 事务的四大特性(ACID)
 - 原子性（Atomicity）： 事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；
 - 一致性（Consistency）： 执行事务后，数据库从一个正确的状态变化到另一个正确的状态；
 - 隔离性（Isolation）： 并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的；
 - 持久性（Durability）： 一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。


## 并发事务带来哪些问题?
 - 脏读： 当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。
 - 丢失修改：指在一个事务读取一个数据时，另外一个事务也访问了该数据，那么在第一个事务中修改了这个数据后，第二个事务也修改了这个数据。这样第一个事务内的修改结果就被丢失，因此称为丢失修改。
 - 不可重复读：指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。
 - 幻读：幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。

## 事务隔离级别有哪些?MySQL的默认隔离级别是?
 - READ-UNCOMMITTED(读取未提交)： 最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或不可重复读。
 - READ-COMMITTED(读取已提交)： 允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或不可重复读仍有可能发生。
 - REPEATABLE-READ(可重复读)： 对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止脏读和不可重复读，但幻读仍有可能发生。
 - SERIALIZABLE(可串行化)： 最高的隔离级别，完全服从ACID的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，该级别可以防止脏读、不可重复读以及幻读。


## MySQL 优化

 - 优化SQL语句和索引

 - 加缓存,memcached,redis;

 - 在应用层实现主从复制，读写分离：1.在应用层实现。2.数据库中间件实现。

 - MySQL自带分区表。将表进行分区。

 - 垂直拆分，将一个大的系统拆分为多个小的系统。

 - 最后是水平切分
